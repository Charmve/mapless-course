# mapless-course

No HDMap, Only Vision Perception 


<div align="right">
  👆 右上角点击 <img class="ai-header-badge-img" src="https://img.shields.io/github/stars/Charmve/OccNet-Course.svg?style=social&label=Star"> 告诉我，你希望这个课程早点开课 ❤️ & ☕️
</div>

<img width="1824" alt="image" src="https://github.com/Charmve/mapless-course/assets/29084184/a8ff2c8a-9e88-4cbe-8c93-b060b3a0d0f2">

<img width="488" alt="实时生成HD-Map的几种神经网络" src="https://github.com/Charmve/mapless-course/assets/29084184/e7a817e6-8df6-4006-b064-0f7d1a0ee39a">

![image](https://github.com/Charmve/mapless-course/assets/29084184/156a24e0-c952-4cd7-9036-16e22c93818c)


<p align="center">
  扫码学习课程<br>

  <img width="320" src="https://github.com/Charmve/computer-vision-in-action/assets/29084184/05068a02-dd55-471e-90ea-f9e5ba6974fe" alts="vx: YidaZhang2">
  <br>
  微信咨询：Yida_Zhang2
</p>

<h2 align="center">课程咨询与购买</h2>

课程采用预售方式，本仓库 🌟 Star 数超过1k，或预定人数超过 100人 后，将会上线全部课程和源代码。

<table>
  <tbody>
    <th>
      <td>
        学生价
      </td>
      <td>
        在职个人
      </td>
      <td>
        企业员工（可开企业发票）
      </td>
    </th>
    <tr>
      <td>
        标准版（仅包含本次课程费用）
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
      </td>
    </tr>
    <tr>
      <td>
        进阶版（包含后续课程更新）
      </td>
      <td>
      </td>
      <td>
      </td>
      <td>
      </td>
    </tr>
  </tbody>
</table>

<br><br>

-------------

## 《矢量高精地图实时在线构建及BEV表示学习

An Course about End-to-End Framework for Online Vectorized HD Map Construction

提 纲 

1、自动驾驶中的离线建图和在线建图

2、高精地图要素的结构化建模

3、2D-to-BEV表示学习方法GKT

4、实时在线建图方法MapTR、VectorMapNet、HDMapNet


<div class="section">
    <h3>Qualitative Results</h3>
    <div class="logo" style="" align="center">
        <img style="width: 700pt;" src="https://tsinghua-mars-lab.github.io/vectormapnet/images/qualitative_hdmapnet.png">
    </div>
    <p>
        Qualitative results generated by VectorMapNet and baselines. We use camera images as inputs for comparisons. The areas enclosed by <font color="#FF0000">red</font> and <font color="#0000FF">blue</font> ellipses show that VectorMapNet can preserve sharp corners, and polyline representations prevent VectorMapNet from generating ambiguous self-looping results.
    </p>
    <div class="logo" style="" align="center">
        <img style="width: 700pt;" src="https://tsinghua-mars-lab.github.io/vectormapnet/images/qualitative_example.png">
    </div>
    <p>
        An example of VectorMapNet detecting unlabeled map elements. The <font color="#FF0000">red ellipse</font> indicates a pedestrian crossing that is missing in ground truth annotations, while VectorMapNet detects it correctly. All the predictions are generated from camera images.
    </p>
</div>


<div class="section">
    <h3>Motivation</h3>
    <div class="logo" style="" align="center">
        <img style="width: 700pt;" src="https://tsinghua-mars-lab.github.io/vectormapnet/images/teaser_vmp.png">
    </div>
    <p>
        Most recent HD map learning methods use dense primitives (e.g., pixels) to model maps. But learning these dense primitives complicates the pipeline and restricts the model's scalability and performance. In VectorMapNet, we represent map elements as a set of polylines that are easily linked to downstream tasks (e.g., motion forecasting), and model these polylines with a set prediction framework. The overview of our idea is presented in the Figure above. 
    </p>
</div>

<div class="section">
    <h3>Method</h3>
    <p>
        Our task is to model map elements in the urban environments in a vectorized form using data from onboard sensors, e.g., RGB cameras and/or LiDARs. These map elements include but are not limited to road boundaries, lane dividers, and pedestrian crossings, which are critical for autonomous driving.
    </p>
    <figure>
        <!-- <img style="width: 700pt;" src="images/overview_vmp.png"> -->
        <img style="width: 700pt;" src="https://tsinghua-mars-lab.github.io/vectormapnet/images/VectorMapNet_Pipelinex2.gif">
    </figure>
    <p>
        There are three key ingredients in our vectorized HD map generation pipeline, as shown in above figure.
    </p>
    <ul>
        <li>
            A <b>BEV feature extractor</b> that map sensor data from sensor-view to a canonical BEV representation<mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="0" style="font-size: 114.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-msub><mjx-texatom texclass="ORD"><mjx-mi class="mjx-cal mjx-i"><mjx-c class="mjx-c46 TEX-C"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: -0.15em; margin-left: -0.11em;"><mjx-texatom size="s" texclass="ORD"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-n"><mjx-c class="mjx-c42"></mjx-c><mjx-c class="mjx-c45"></mjx-c><mjx-c class="mjx-c56"></mjx-c></mjx-mi></mjx-texatom></mjx-texatom></mjx-script></mjx-msub></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow data-mjx-texclass="ORD"><mi data-mjx-variant="-tex-calligraphic" mathvariant="script">F</mi></mrow><mrow data-mjx-texclass="ORD"><mrow data-mjx-texclass="ORD"><mi data-mjx-auto-op="false">BEV</mi></mrow></mrow></msub></math></mjx-assistive-mml></mjx-container>.
        </li> 
        <li>
            A scene-level <b>map element detector</b> that locates and classifies all map elements by predicting element keypoints <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="1" style="font-size: 114.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-cal mjx-i"><mjx-c class="mjx-c41 TEX-C"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-msup space="4"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-ds mjx-b"><mjx-c class="mjx-c211D TEX-A"></mjx-c></mjx-mi></mjx-texatom><mjx-script style="vertical-align: 0.363em;"><mjx-texatom size="s" texclass="ORD"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D458 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-cD7"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c class="mjx-c32"></mjx-c></mjx-mn></mjx-texatom></mjx-script></mjx-msup><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mi data-mjx-variant="-tex-calligraphic" mathvariant="script">A</mi></mrow><mo>=</mo><mo fence="false" stretchy="false">{</mo><msub><mi>a</mi><mi>i</mi></msub><mo>∈</mo><msup><mrow data-mjx-texclass="ORD"><mi mathvariant="double-struck">R</mi></mrow><mrow data-mjx-texclass="ORD"><mi>k</mi><mo>×</mo><mn>2</mn></mrow></msup><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>N</mi><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container> and their class labels <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="2" style="font-size: 114.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-texatom texclass="ORD"><mjx-mi class="mjx-cal mjx-i"><mjx-c class="mjx-c4C TEX-C"></mjx-c></mjx-mi></mjx-texatom><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c7B"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c2208"></mjx-c></mjx-mo><mjx-texatom space="4" texclass="ORD"><mjx-mi class="mjx-ds mjx-b"><mjx-c class="mjx-c2124 TEX-A"></mjx-c></mjx-mi></mjx-texatom><mjx-texatom texclass="ORD"><mjx-mo class="mjx-n"><mjx-c class="mjx-c7C"></mjx-c></mjx-mo></mjx-texatom><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n" space="4"><mjx-c class="mjx-c3D"></mjx-c></mjx-mo><mjx-mn class="mjx-n" space="4"><mjx-c class="mjx-c31"></mjx-c></mjx-mn><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2026"></mjx-c></mjx-mo><mjx-mo class="mjx-n" space="2"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-mi class="mjx-i" space="2"><mjx-c class="mjx-c1D441 TEX-I"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c class="mjx-c7D"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow data-mjx-texclass="ORD"><mi data-mjx-variant="-tex-calligraphic" mathvariant="script">L</mi></mrow><mo>=</mo><mo fence="false" stretchy="false">{</mo><msub><mi>l</mi><mi>i</mi></msub><mo>∈</mo><mrow data-mjx-texclass="ORD"><mi mathvariant="double-struck">Z</mi></mrow><mrow data-mjx-texclass="ORD"><mo stretchy="false">|</mo></mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>N</mi><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container>.
        </li>
        <li>
            An object-level <b>polyline generator</b> that produces a polyline vertices sequence for each detected map element <mjx-container class="MathJax CtxtMenu_Attached_0" jax="CHTML" tabindex="0" ctxtmenu_counter="3" style="font-size: 114.5%; position: relative;"><mjx-math class="MJX-TEX" aria-hidden="true"><mjx-mo class="mjx-n"><mjx-c class="mjx-c28"></mjx-c></mjx-mo><mjx-msub><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D44E TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c2C"></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi class="mjx-i"><mjx-c class="mjx-c1D459 TEX-I"></mjx-c></mjx-mi><mjx-script style="vertical-align: -0.15em;"><mjx-mi class="mjx-i" size="s"><mjx-c class="mjx-c1D456 TEX-I"></mjx-c></mjx-mi></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c class="mjx-c29"></mjx-c></mjx-mo></mjx-math><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>l</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>.
        </li>  
    </ul>  
</div>


#### MapTR/MapTRv2 maintains stable and robust map construction quality in various driving scenes.

<img src="https://github.com/hustvl/MapTR/raw/main/assets/MapTRv2_av2_visualizations.png">

<!---
### *Sunny&Cloudy*
https://user-images.githubusercontent.com/31960625/187059686-11e4dd4b-46db-4411-b680-17ed6deebda2.mp4

### *Rainy*
https://user-images.githubusercontent.com/31960625/187059697-94622ddb-e76a-4fa7-9c44-a688d2e439c0.mp4

### *Night*
https://user-images.githubusercontent.com/31960625/187059706-f7f5a7d8-1d1d-46e0-8be3-c770cf96d694.mp4 --->

### *End-to-end Planning based on MapTR*
https://user-images.githubusercontent.com/26790424/229679664-0e9ba5e8-bf2c-45e0-abbc-36d840ee5cc9.mp4


-------

### 参考资料

- https://zhuanlan.zhihu.com/p/637553715?utm_psn=1702473638601879554
- https://zhuanlan.zhihu.com/p/574687904
- https://github.com/hustvl/MapTR
- https://tsinghua-mars-lab.github.io/vectormapnet/

